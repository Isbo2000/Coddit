<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Coddit 5.0</title>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="icon" type="image/png" href="https://cdn.discordapp.com/attachments/742845528806522903/905083099505913886/communityIcon_tl264bd22xw71.png"/>
		<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet">
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js"></script>
		<link rel="stylesheet" href="style.css">
		<script type="text/javascript" src="https://code.jquery.com/jquery-3.5.1.js"></script>

<!----- I dont know what i did, but everything between these two comments cannot be changed at all ----->
		<style type="text/css">
			table {
				width:  100%;
				border-collapse: collapse;
			}
			.main {
				width: 30em;
				overflow-y: auto;
			}
		</style>
		<script type="text/javascript">
			function makeTableScroll() {
				var maxRows = 1;
				var table = document.getElementById('user_data');
				var wrapper = table.parentNode;
				var rowsInTable = table.rows.length;
				var height = 0;
				if (rowsInTable > maxRows) {
					for (var i = 0; i < maxRows; i++) {
						height += table.rows[i].clientHeight;
					}
					wrapper.style.height = height + "px";
				}
			}
		</script>
	</head>
	<body onload="makeTableScroll()">
<!------- this is apperently now required to make the title scroll with the table, pls help ;-; ------>

		<div class="tab w3-sidebar w3-bar-block w3-collapse w3-card w3-animate-left" style="width:200px;" id="mySidebar">
			<button class="w3-bar-item w3-button w3-large w3-hide-large" style="text-align:center;border-bottom:1px solid gray;" onclick="w3_close()">Close &times;</button>
			<ul style="list-style-type:none;padding:0;margin:0;" id="menu">
				<li id="listheader"> <b>Sort By</b></li>
				<li>
					<button class="tablinks" onclick="getpage('all-time',n);page='all-time';w3_close()">All Time</button>
				</li>
				<li>
					<button class="tablinks" onclick="getpage('data',n);page='data';w3_close()">This Month</button>
				</li>
				<li>
					<button class="tablinks" onclick="getpage('October2021',n);page='October2021';w3_close()">October 2021</button>
				</li>
				<li>
					<button class="tablinks" onclick="getpage('November2021',n);page='November2021';w3_close()">November 2021</button>
				</li>
				<li>
					<button class="tablinks" onclick="getpage('December2021',n);page='December2021';w3_close()">December 2021</button>
				</li>
				<li>
					<button class="tablinks" onclick="getpage('January2022',n);page='January2022';w3_close()">January 2022</button>
				</li>
				<li>
					<button class="tablinks" onclick="getpage('February2022',n);page='February2022';w3_close()">February 2022</button>
				</li>
				<hr>
				<li id="listheader"> <b>Appearance</b></li>
				<li>
					<button class="tablinks" onclick="darkmode();w3_close()">Toggle Light Mode</button>
				</li>
				<hr>
				<li id="listheader"><b>Tools</b></i></li>
				<li>
					<a class="tablinks" href="https://www.reddit.com/r/teenagersbutpog" style="text-decoration: none;">Back to Subreddit</a>
				</li>
			</ul>
		</div>
		<div id="main">
			<div class="w3-main" style="margin-left:200px;" id="title">
				<div id="titleteal">
					<button id="openNav" class="w3-button w3-xlarge w3-hide-large" onclick="w3_open()"><i class="fa fa-bars"></i></button>
					<div class="w3-container" id="dropdownandtitle">
						<h1 class="w3-animate-top" style="display:inline;">r/TeenagersButPog's Official Coddit</h1>
					</div>
				</div>
				<p id="disp-p-s" style="margin-left:10px;" style="margin-top:10px;">This Month</p>
			</div>
			<table id="user_data" style="width:70%" style="margin-left:250px;">
				<tr>
					<td colspan="5"><i id="help"></i><br><input type="text" id="searchtable" onkeyup="search()" placeholder="Search Users..." title="Type a user"></td>
				</tr>
				<tr>
					<th style="width: 10%">Rank</th>
					<th style="width: 30%">Username <a href="https://www.reddi.com/users/"><i class="extlink fa fa-external-link"></i></a></th>
					<th id="sort" onclick="getpage(page,1);n=1" style="width: 20%">Posts</a></th>
					<th id="sort" onclick="getpage(page,2);n=2" style="width: 20%">Comments</a></th>
					<th id="sort" onclick="getpage(page,0);n=0" style="width: 20%">Total</a></th>
				</tr>
				<script>
					$(document).ready(function () {
						page = "data"
						n = 0
						getpage(page,n)
					});
				</script>
			</table>
		</div>
		<script>
			function getpage(page,n) {
				$(document).ready(function () {
					url = "https://isbo-coddit-default-rtdb.firebaseio.com/"+page+".json"
					fetch(url).then(response => {return response.json();}).then(function (data) {
						if(page=="data"){disp="This Month"}else if(page=="all-time"){disp="All Time"}else{disp=page}
						if(n==0){srt="posts and comments"}else if(n==1){srt="posts"}else if(n==2){srt="comments"}
						document.getElementById("disp-p-s").textContent = disp+" ~ sorted by "+srt
						var sortable = [];
						for (var user in data) {
							sortable.push([user, data[user][0], data[user][1]]);
						}
						if (n==0){
							sortable.sort(function(a, b) {return (b[1]+b[2]) - (a[1]+a[2])});}
						else if (n==1){
							sortable.sort(function(a, b) {return b[1] - a[1]});
						}
						else if (n==2){
							sortable.sort(function(a, b) {return b[2] - a[2]});
						}
						if (user_data) {
							var rowCount = user_data.rows.length;
							for (var i = rowCount - 1; i > 1; i--) {
								user_data.deleteRow(i);
							}
						}
						for (var i = 0; i < sortable.length; i++) {
							var student = "<tr><td>";
							student += i + 1;
							student += "</td><td>";
							student += "<a href= https://reddit.com/user/" + sortable[i][0] + ">";
							student += sortable[i][0];
							student += "</a>";
							student += "</td><td>";
							student += sortable[i][1];
							student += "</td><td>";
							student += sortable[i][2];
							student += "</td><td>";
							student += sortable[i][1] + sortable[i][2];
							student += "</td></tr>";
							$('#user_data').append(student);
						};
					});
				});
			}
			var items = ["Take breaks!", "Developed by Dimittrikov and Daniel_R013 (and me hehe)", "It's important to stay independent", "Remember to breathe", "In through the nose and out through the mouth",
				"Call your local crisis line when things get especially sticky", "We love having you around", "You're worthy", "A break from reddit every so often is always helpful!", "Stay true to you!",
				"Be you", "You look wonderful! You should show everyone sometime", "Keep it up", "r/teenagersbutpog, since April 2021", "Coddit 5.0", "Woah, quite the reddit usage there!", "Impressive",
				"All things are difficult before they are easy", "Don't light yourself on fire to keep others warm", "The secret of getting ahead is getting started", "When something is important enough, you do it even if the odds are not in your favor",
				"There's a subreddit vent chat, go check it out!", "HEY! YOU, YES YOU, YOU. YOU'RE AMAZING!", "It's only embarrassing if you're embarrassed", "Holding on to anger is like drinking poison and hoping the other person dies",
				"When life shuts a door, open it again, it's a door, that's how they work", "You will meet people that see a lot more in you than you do in yourself", "You are an incredible person", "Work it!", "Those who matter don't mind and those who mind don't matter",
				"You matter", "You matter to us", "Be yourself more", "Show the world who you are, because who you are is an amazing person", "We love you for you", "Keep on swimming", "Good work!", "Treat yourself", "Treat yourself you deserve it", "I like your style",
				"Youâ€™re perfect just the way you are", "You make people's days", "You're probably smart enough to do a crossword puzzle in pen", "Chill oooouuuuutttt B)", "Square up!", "Pleasure to meet you", "Welcome!", "Woah, impressive",
				"Talk to a trusted family member or friend whenever you get into a pickle", "Your friends probably love you more than you realize, damn", "People who are goodlooking but have terrible personalities are basically real life clickbaits"]
			var item = items[Math.floor(Math.random() * items.length)];
			document.getElementById("help").innerHTML = item;
			function darkmode() {
				document.body.classList.toggle("dark-mode");
			}
			function w3_open() {
				document.getElementById("mySidebar").style.display = "block";
				document.getElementById("mySidebar").style.width = "65%";
				document.getElementById("main").style.opacity = "0.6";
			}
			function w3_close() {
				document.getElementById("main").style.opacity = "1";
				document.getElementById("mySidebar").style.display = "none";
			}
			function search() {
				var input, filter, table, tr, td, i, txtValue;
				input = document.getElementById("searchtable");
				filter = input.value.toUpperCase();
				table = document.getElementById("user_data");
				tr = table.getElementsByTagName("tr");
				for (i = 0; i < tr.length; i++) {
					td = tr[i].getElementsByTagName("td")[1];
					if (td) {
						txtValue = td.textContent || td.innerText;
						if (txtValue.toUpperCase().indexOf(filter) > -1) {
							tr[i].style.display = "";
						}
						else {
							tr[i].style.display = "none";
						}
					}
				}
			}
		</script>
	</body>
</html>
